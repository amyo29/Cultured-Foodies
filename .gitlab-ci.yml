# test-job:
#   stage: build
#   script:
#     - echo "Hello, $GITLAB_USER_LOGIN!"

python-unit-tests:
  image: python:3.7
  stage: test
  script:
    - pip install -r backend/requirements.txt
    - make python-unit-tests

selenium-tests:
  image: python:3.7
  stage: test
  script:
    - cd frontend

    # from https://sqa.stackexchange.com/questions/46991/how-to-install-chrome-webdriver-on-gitlab-ci-cd
    
    # Update apt-get and install pip
    - apt-get update
    - apt-get install -y python3-pip
     # Install the chrome and chrome webdriver
    - apt-get install -y xvfb
    - apt-get install -y zip
    - apt-get install -y wget
    - apt-get install -y ca-certificates
    - apt-get install -y libnss3-dev libasound2 libxss1 libappindicator3-1 libindicator7 gconf-service libgconf-2-4 libpango1.0-0 xdg-utils fonts-liberation libgbm1
    - wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb 
    - dpkg -i google-chrome*.deb 
    - rm google-chrome*.deb
    - wget -N http://chromedriver.storage.googleapis.com/89.0.4389.23/chromedriver_linux64.zip
    - unzip chromedriver_linux64.zip
    - chmod +x chromedriver
    - cp chromedriver /usr/local/bin
    - rm chromedriver_linux64.zip
    - rm chromedriver

    - python3 selenium_tests.py

# deploy-prod:
#   stage: deploy
#   script:
#     - echo "This job deploys something from the $CI_COMMIT_BRANCH branch."